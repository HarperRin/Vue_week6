"use strict";(self["webpackChunkvue_week6"]=self["webpackChunkvue_week6"]||[]).push([[36],{1530:function(e,t,a){function s(e){return{all:e=e||new Map,on:function(t,a){var s=e.get(t);s?s.push(a):e.set(t,[a])},off:function(t,a){var s=e.get(t);s&&(a?s.splice(s.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var s=e.get(t);s&&s.slice().map((function(e){e(a)})),(s=e.get("*"))&&s.slice().map((function(e){e(t,a)}))}}}a.d(t,{Z:function(){return i}});const l=s();var i=l},6036:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var s=a(6252),l=a(3577),i=a(9963);const o=(0,s._)("h2",{class:"text-center mt-5"},"前台購物車",-1),n={class:"container mt-5"},r={class:"row justify-content-center"},d={class:"text-end"},c=["disabled"],m={class:"table align-middle mt-3"},u=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"150px"}},"數量/單位"),(0,s._)("th",{class:"text-end"},"單價")])],-1),h=["onClick","disabled"],p={key:0,class:"fas fa-spinner fa-pulse"},g=(0,s.Uk)(" 移除購物車 "),f={class:"input-group input-group-sm"},b={class:"input-group mb-3"},_=["onUpdate:modelValue","onChange","disabled"],v=["value"],x={class:"input-group-text",id:"basic-addon2"},C={class:"text-end"},y=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),w={class:"text-end"},k={class:"my-4 row justify-content-center"},V=(0,s._)("h3",{class:"text-center mt-5"},"收件人資訊",-1),L={class:"mb-3"},D=(0,s._)("label",{for:"email",class:"form-label"},"Email",-1),I={class:"mb-3"},$=(0,s._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),q={class:"mb-3"},W=(0,s._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),U={class:"mb-3"},O=(0,s._)("label",{for:"address",class:"form-label"},"收件人地址",-1),z={class:"mb-3"},Z=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),M={class:"text-end"},j=["disabled"];function A(e,t,a,A,E,F){const H=(0,s.up)("VLoading"),S=(0,s.up)("VField"),Y=(0,s.up)("ErrorMessage"),K=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)(s.HY,null,[o,(0,s.Wm)(H,{active:E.isLoading},null,8,["active"]),(0,s._)("div",n,[(0,s._)("div",r,[(0,s._)("div",d,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...e)=>F.deleteCartAll&&F.deleteCartAll(...e)),disabled:0===E.cartData.carts.length}," 清空購物車 ",8,c)]),(0,s._)("table",m,[u,(0,s._)("tbody",null,[E.cartData.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(E.cartData.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>F.removeCartItem(e.id),disabled:E.isLoadingItem===e.id},[E.isLoadingItem===e.id?((0,s.wg)(),(0,s.iD)("i",p)):(0,s.kq)("",!0),g],8,h)]),(0,s._)("td",null,(0,l.zw)(e.product.title),1),(0,s._)("td",null,[(0,s._)("div",f,[(0,s._)("div",b,[(0,s.wy)((0,s._)("select",{id:"",class:"form-select","onUpdate:modelValue":t=>e.qty=t,onChange:t=>F.updateCartItem(e),disabled:E.isLoadingItem===E.product.id},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(t=>(0,s._)("option",{value:t,key:`${t}+${e.id}`},(0,l.zw)(t),9,v))),64))],40,_),[[i.bM,e.qty]]),(0,s._)("span",x,(0,l.zw)(e.product.unit),1)])])]),(0,s._)("td",C,(0,l.zw)(e.total),1)])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[y,(0,s._)("td",w,(0,l.zw)(E.cartData.total),1)])])])]),(0,s._)("div",k,[V,(0,s.Wm)(K,{ref:"form",class:"col-md-6",onSubmit:F.createOrder},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",L,[D,(0,s.Wm)(S,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:E.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>E.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(Y,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",I,[$,(0,s.Wm)(S,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:E.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>E.form.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(Y,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",q,[W,(0,s.Wm)(S,{id:"tel",name:"電話",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:F.isPhone,modelValue:E.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>E.form.user.tel=e),required:""},null,8,["class","rules","modelValue"]),(0,s.Wm)(Y,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",U,[O,(0,s.Wm)(S,{id:"address",name:"地址",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:E.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>E.form.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(Y,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",z,[Z,(0,s.wy)((0,s._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=e=>E.form.message=e)},null,512),[[i.nr,E.form.message]])]),(0,s._)("div",M,[(0,s._)("button",{type:"submit",class:"btn btn-danger",disabled:!E.cartData.carts.length||Object.keys(e).length>0,onSubmit:t[6]||(t[6]=(0,i.iM)(((...e)=>F.createOrder&&F.createOrder(...e)),["prevent"]))}," 送出訂單 ",40,j)])])),_:1},8,["onSubmit"])])])],64)}var E=a(1530),F={data(){return{isLoading:!1,cartData:{carts:[]},product:{},isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2/api/hlin-hexschool/cart";this.$http(e).then((e=>{this.cartData=e.data.data,this.isLoading=!1})).catch((e=>{alert(e.data.message)}))},removeCartItem(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/hlin-hexschool/cart/${e}`;this.$http.delete(t).then((e=>{alert(e.data.message),this.isLoading=!1,E.Z.emit("cart-length"),this.getCart()})).catch((e=>{alert(e.data.message)}))},deleteCartAll(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/v2/api/hlin-hexschool/carts";this.$http.delete(e).then((e=>{alert(e.data.message),this.isLoading=!1,E.Z.emit("cart-length"),this.getCart()})).catch((e=>{alert(e.data.message)}))},updateCartItem(e){const t=`https://vue3-course-api.hexschool.io/v2/api/hlin-hexschool/cart/${e.id}`,a={product_id:e.id,qty:e.qty};this.isLoadingItem=e.id,this.$http.put(t,{data:a}).then((e=>{alert(e.data.message),this.isLoadingItem="",E.Z.emit("cart-length"),this.getCart()})).catch((e=>{console.log(e.data.message),alert(e.data.message),this.isLoadingItem=""}))},createOrder(){this.isLoading=!0;const e=this.form,t="https://vue3-course-api.hexschool.io/v2/api/hlin-hexschool/order";this.$http.post(t,{data:e}).then((e=>{alert(e.data.message),this.$refs.form.resetForm(),this.isLoading=!1,this.getCart()})).catch((e=>{console.log(e)}))},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"電話 須為正確的電話號碼"}},mounted(){this.getCart()}},H=a(3744);const S=(0,H.Z)(F,[["render",A]]);var Y=S}}]);
//# sourceMappingURL=36.685b3d70.js.map